<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="static/images/icon.png" type="image/png" sizes="168x168">
  <title>Consultium AI - Professional Medical Documentation</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Custom styles */
    * { font-family: 'Inter', sans-serif; }
    
    /* Loading overlay */
    #loading-overlay {
      position: fixed;
      inset: 0;
      background: rgba(255,255,255,0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
      backdrop-filter: blur(4px);
    }
    
    .spinner {
      border: 3px solid #e5e7eb;
      border-top-color: #3b82f6;
      border-radius: 50%;
      width: 2.5rem;
      height: 2.5rem;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Professional gradient backgrounds */
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .blue-gradient {
      background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
    }
    
    /* Card hover effects */
    .hover-lift {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .hover-lift:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    /* Feature cards */
    .feature-card {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      border: 1px solid #e5e7eb;
      transition: all 0.3s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    /* Coming Soon cards */
    .coming-soon-card {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      border: 2px dashed #cbd5e1;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .coming-soon-card:hover {
      transform: translateY(-2px);
      border-color: #94a3b8;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .coming-soon-badge {
      position: absolute;
      top: 10px;
      right: -25px;
      background: linear-gradient(45deg, #3b82f6, #06b6d4);
      color: white;
      padding: 6px 35px;
      font-size: 0.7rem;
      font-weight: 700;
      transform: rotate(35deg);
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
      letter-spacing: 0.5px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }
    
    .coming-soon-content {
      filter: grayscale(0.3);
      opacity: 0.8;
    }
    
    .pulse-glow {
      animation: pulse-glow 2s ease-in-out infinite alternate;
    }
    
    @keyframes pulse-glow {
      from {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      }
      to {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 0 20px rgba(59, 130, 246, 0.3);
      }
    }
    
    .lamp-pulse {
      animation: lamp-pulse 1.5s ease-in-out infinite alternate;
    }
    
    @keyframes lamp-pulse {
      from {
        box-shadow: 0 0 5px rgba(251, 191, 36, 0.5);
      }
      to {
        box-shadow: 0 0 15px rgba(251, 191, 36, 0.8);
      }
    }
    
    
    
    /* SOEP sections */
    .soep-section {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      border: 1px solid #e5e7eb;
    }
    
    /* Live typing animation */
    @keyframes typing-cursor {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    
    .typing-cursor::after {
      content: '|';
      animation: typing-cursor 1s infinite;
      color: #3b82f6;
      font-weight: bold;
    }
    
    .live-transcription {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
      border: 2px solid #0ea5e9;
      box-shadow: 0 0 20px rgba(14, 165, 233, 0.2);
    }
    
    .recording-indicator {
      animation: pulse-red 1.5s infinite;
    }
    
    @keyframes pulse-red {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    /* Navigation tabs */
    .nav-tab {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
         .nav-tab.active {
       background: linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%);
       color: white;
     }
    
    .nav-tab:not(.active) {
      background: #f8fafc;
      color: #64748b;
    }
    
    .nav-tab:not(.active):hover {
      background: #e2e8f0;
      color: #475569;
    }
    
    /* Custom scrollbar */
    .custom-scrollbar::-webkit-scrollbar {
      width: 6px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-track {
      background: #f1f5f9;
      border-radius: 3px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #cbd5e1;
      border-radius: 3px;
    }
    
    .custom-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #94a3b8;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <!-- Loading overlay -->
  <div id="loading-overlay">
    <div class="text-center">
      <div class="spinner mx-auto mb-4"></div>
      <p class="text-gray-600">Verwerken...</p>
    </div>
  </div>

  <!-- Header -->
  <header class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
    <div class="flex items-center space-x-3">
          <img src="static/images/logo.png" alt="Consultium AI" class="h-32 w-auto">
    </div>
        
                 <!-- Navigation -->
         <nav class="hidden md:flex space-x-8">
           <button class="nav-tab active" data-tab="dashboard">Dashboard</button>
           <button class="nav-tab" data-tab="soep">SOEP Verslag</button>
           <button class="nav-tab" data-tab="tolk">Live Tolk</button>
         </nav>
        
        <!-- Profile -->
    <div class="relative">
          <button onclick="toggleMenu()" class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
            <img src="static/images/default.png" alt="Profiel" class="w-10 h-10 rounded-full border border-gray-300 cursor-pointer">
          </button>
          <div id="dropdown-menu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-50 border border-gray-200">
            <a href="#" class="block px-4 py-2 text-gray-700 hover:bg-gray-50">Account Instellingen</a>
            <a href="index.html" class="block px-4 py-2 text-gray-700 hover:bg-gray-50">Uitloggen</a>
          </div>
        </div>
      </div>
    </div>
  </header>



  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    
    <!-- Dashboard Tab -->
    <div id="dashboard-tab" class="tab-content">
             <!-- Hero Section -->
       <div class="blue-gradient rounded-2xl p-8 text-white mb-8">
        <div class="max-w-3xl">
          <h1 class="text-4xl font-bold mb-4">Welkom bij Consultium AI</h1>
          <p class="text-xl mb-6 opacity-90">Revolutioneer uw medische documentatie met AI-gestuurde SOEP-verslagen en real-time transcriptie.</p>
                                <div class="flex flex-wrap gap-4">
             <button onclick="switchTab('soep')" class="px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
               Start SOEP Verslag
             </button>
           </div>
        </div>
      </div>

             <!-- Feature Cards -->
       <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
         <!-- Available Features (Top Row) -->
         <div class="feature-card hover-lift">
           <div class="flex items-center mb-4">
             <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
               <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
               </svg>
             </div>
             <h3 class="text-xl font-semibold text-gray-900">SOEP Verslag</h3>
           </div>
           <p class="text-gray-600 mb-4">Automatische structurering volgens NHG-richtlijnen binnen seconden.</p>
           <button onclick="switchTab('soep')" class="text-blue-600 font-medium hover:text-cyan-600">Probeer nu ‚Üí</button>
         </div>

         <div class="feature-card hover-lift">
           <div class="flex items-center mb-4">
             <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mr-4">
               <svg class="w-6 h-6 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m10.5 21 5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 0 1 6-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.764.147 2.598.266m-2.598-.266C15.176 4.904 18.69.482 23 2.904"></path>
               </svg>
             </div>
             <h3 class="text-xl font-semibold text-gray-900">Live Tolk</h3>
           </div>
           <p class="text-gray-600 mb-4">Real-time vertaling tussen dokter en pati√´nt tijdens consultaties.</p>
           <button onclick="switchTab('tolk')" class="text-orange-600 font-medium hover:text-orange-700">Start vertaling ‚Üí</button>
         </div>

         <div class="feature-card hover-lift">
           <div class="flex items-center mb-4">
             <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
               <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
               </svg>
             </div>
             <h3 class="text-xl font-semibold text-gray-900">Live Opname</h3>
           </div>
           <p class="text-gray-600 mb-4">Real-time transcriptie met 99% nauwkeurigheid tijdens het consult.</p>
           <button onclick="switchTab('soep')" class="text-green-600 font-medium hover:text-green-700">Start opname ‚Üí</button>
         </div>

         <!-- Coming Soon Features (Bottom Row) -->
         <div class="coming-soon-card pulse-glow" style="animation-delay: 0.2s;">
           <div class="coming-soon-badge">BINNENKORT</div>
           <div class="coming-soon-content">
             <div class="flex items-center mb-4">
               <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mr-4 relative">
                 <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                 </svg>
                 <!-- Lamp Alert Icon -->
                 <div class="absolute -top-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full flex items-center justify-center lamp-pulse">
                   <svg class="w-2.5 h-2.5 text-yellow-800" fill="currentColor" viewBox="0 0 20 20">
                     <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                   </svg>
                 </div>
               </div>
               <h3 class="text-xl font-semibold text-gray-700">AI Chat</h3>
             </div>
             <p class="text-gray-500 mb-4">Stel medische vragen en krijg directe, gevalideerde antwoorden.</p>
             <div class="flex items-center text-gray-400 font-medium cursor-not-allowed">
               <svg class="w-4 h-4 mr-2 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                 <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
               </svg>
               Wordt ontwikkeld...
             </div>
           </div>
         </div>

         <div class="coming-soon-card pulse-glow" style="animation-delay: 0.5s;">
           <div class="coming-soon-badge">BINNENKORT</div>
           <div class="coming-soon-content">
             <div class="flex items-center mb-4">
               <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mr-4 relative">
                 <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 3.104v5.714a2.25 2.25 0 01-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 014.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 14.5M14.25 3.104c.251.023.501.05.75.082M19.8 14.5l-2.6 2.6a2.25 2.25 0 01-3.182 0l-2.6-2.6M19.8 14.5V16a2.25 2.25 0 01-2.25 2.25h-8.1A2.25 2.25 0 017.2 16v-1.5m12.6 0a2.25 2.25 0 012.25 2.25V19a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 19v-2.75"></path>
                 </svg>
                 <!-- Lamp Alert Icon -->
                 <div class="absolute -top-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full flex items-center justify-center lamp-pulse">
                   <svg class="w-2.5 h-2.5 text-yellow-800" fill="currentColor" viewBox="0 0 20 20">
                     <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                   </svg>
                 </div>
               </div>
               <h3 class="text-xl font-semibold text-gray-700">AI Diagnostiek</h3>
             </div>
             <p class="text-gray-500 mb-4">Intelligente ondersteuning bij het stellen van diagnoses met medische AI.</p>
             <div class="flex items-center text-gray-400 font-medium cursor-not-allowed">
               <svg class="w-4 h-4 mr-2 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                 <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
               </svg>
               Wordt ontwikkeld...
             </div>
           </div>
         </div>

         <div class="coming-soon-card pulse-glow" style="animation-delay: 1s;">
           <div class="coming-soon-badge">BINNENKORT</div>
           <div class="coming-soon-content">
             <div class="flex items-center mb-4">
               <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center mr-4 relative">
                 <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                   <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"></path>
                 </svg>
                 <!-- Lamp Alert Icon -->
                 <div class="absolute -top-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full flex items-center justify-center lamp-pulse">
                   <svg class="w-2.5 h-2.5 text-yellow-800" fill="currentColor" viewBox="0 0 20 20">
                     <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                   </svg>
                 </div>
               </div>
               <h3 class="text-xl font-semibold text-gray-700">Smart Recepten</h3>
             </div>
             <p class="text-gray-500 mb-4">Automatische receptgeneratie met medicatie-interactie controle.</p>
             <div class="flex items-center text-gray-400 font-medium cursor-not-allowed">
               <svg class="w-4 h-4 mr-2 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                 <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
               </svg>
               Wordt ontwikkeld...
             </div>
           </div>
         </div>
       </div>

      
    </div>

    <!-- SOEP Tab -->
    <div id="soep-tab" class="tab-content hidden">
      <div class="mb-8">
        <h2 class="text-3xl font-bold text-gray-900 mb-2">SOEP Verslag Generator</h2>
        <p class="text-gray-600">Voer uw consultnotities in of gebruik spraakopname voor automatische SOEP-structurering</p>
      </div>

      <!-- Input Section -->
      <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-8">
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-2">Consultnotities</label>
          <textarea 
            id="text-input" 
            placeholder="Voer hier uw consultnotities in of gebruik de opnamefunctie..."
            class="w-full p-4 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            rows="6"
          ></textarea>
    </div>

        <div class="flex flex-wrap gap-4">
          <button id="generate-soep" class="px-6 py-3 blue-gradient text-white rounded-lg font-semibold hover:shadow-lg transition-all duration-300">
            SOEP Genereren
          </button>
          <button id="live-transcribe-btn" class="px-6 py-3 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors flex items-center">
            <span class="recording-indicator mr-2">üî¥</span>
            <span id="transcribe-btn-text">Start Live Transcriptie</span>
          </button>
        </div>
      </div>

      <!-- SOEP Results -->
      <div id="verslag-container" class="hidden">
        <h3 class="text-2xl font-bold text-gray-900 mb-6">Gegenereerd SOEP Verslag</h3>
        <div class="grid gap-6">
          <div id="s-section" class="soep-section">
            <div class="flex justify-between items-center mb-4">
              <h4 class="text-xl font-semibold text-gray-900">S - Subjectief</h4>
              <button onclick="copySection('s-content')" class="px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors">
                üìã Kopi√´ren
              </button>
            </div>
            <div id="s-content" class="text-gray-700 leading-relaxed"></div>
          </div>

          <div id="o-section" class="soep-section">
            <div class="flex justify-between items-center mb-4">
              <h4 class="text-xl font-semibold text-gray-900">O - Objectief</h4>
              <button onclick="copySection('o-content')" class="px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors">
                üìã Kopi√´ren
              </button>
            </div>
            <div id="o-content" class="text-gray-700 leading-relaxed"></div>
          </div>

          <div id="e-section" class="soep-section">
            <div class="flex justify-between items-center mb-4">
              <h4 class="text-xl font-semibold text-gray-900">E - Evaluatie</h4>
              <button onclick="copySection('e-content')" class="px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors">
                üìã Kopi√´ren
              </button>
            </div>
            <div id="e-content" class="text-gray-700 leading-relaxed"></div>
          </div>

          <div id="p-section" class="soep-section">
            <div class="flex justify-between items-center mb-4">
              <h4 class="text-xl font-semibold text-gray-900">P - Plan</h4>
              <button onclick="copySection('p-content')" class="px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 transition-colors">
                üìã Kopi√´ren
              </button>
            </div>
            <div id="p-content" class="text-gray-700 leading-relaxed"></div>
          </div>
        </div>
      </div>
    </div>



     <!-- Live Tolk Tab -->
     <div id="tolk-tab" class="tab-content hidden">
       <div class="mb-8">
         <h2 class="text-3xl font-bold text-gray-900 mb-2">Live Tolk - Intelligente Vertaling</h2>
         <p class="text-gray-600">Automatische taaldetectie en vertaling - spreek gewoon en de AI doet de rest!</p>
       </div>

       <!-- Language Selection -->
       <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-8">
         <h3 class="text-xl font-semibold text-gray-900 mb-4">Taal Instellingen</h3>
         <div class="grid md:grid-cols-2 gap-6">
           <div>
             <label class="block text-sm font-medium text-gray-700 mb-2">Taal 1 (meestal Nederlands)</label>
             <select id="language-1" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
               <option value="nl">Nederlands</option>
               <option value="en">English</option>
               <option value="fr">Fran√ßais</option>
               <option value="de">Deutsch</option>
               <option value="es">Espa√±ol</option>
             </select>
           </div>
           <div>
             <label class="block text-sm font-medium text-gray-700 mb-2">Taal 2 (pati√´nt taal)</label>
             <select id="language-2" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
               <option value="en">English</option>
               <option value="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
               <option value="tr">T√ºrk√ße</option>
               <option value="pl">Polski</option>
               <option value="es">Espa√±ol</option>
               <option value="fr">Fran√ßais</option>
               <option value="de">Deutsch</option>
               <option value="it">Italiano</option>
               <option value="pt">Portugu√™s</option>
               <option value="ru">–†—É—Å—Å–∫–∏–π</option>
               <option value="zh">‰∏≠Êñá</option>
               <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
               <option value="ur">ÿßÿ±ÿØŸà</option>
             </select>
           </div>
         </div>
       </div>

       <!-- Single Recording Interface -->
       <div class="bg-white rounded-2xl p-8 shadow-sm border border-gray-200 mb-8">
         <div class="text-center mb-6">
           <div id="tolk-status" class="px-4 py-2 bg-gray-100 text-gray-600 rounded-full text-sm inline-block mb-4">
             Klaar om te starten
           </div>
           
           <div class="mb-6">
             <button id="tolk-record-btn" class="w-24 h-24 rounded-full bg-gradient-to-r from-blue-600 to-cyan-600 text-white flex items-center justify-center hover:shadow-lg transition-all duration-300 transform hover:scale-105 mx-auto">
               <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                 <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
               </svg>
             </button>
             <p class="text-lg text-gray-600 mt-3">Klik om te spreken</p>
             <p class="text-sm text-gray-500">Live spraak-naar-spraak vertaling - spreek en luister direct</p>
           </div>
         </div>

         <!-- Language 1 (Doctor) -->
         <div class="mb-6">
           <h4 class="text-lg font-semibold text-gray-900 mb-3">Taal van arts <span id="doctor-lang-display" class="text-sm text-gray-500">(Nederlands)</span></h4>
           <div id="live-transcript" class="min-h-24 p-4 bg-gray-50 rounded-lg border border-gray-200 text-gray-700">
             <span class="text-gray-400">Gesproken woorden verschijnen hier...</span>
           </div>
         </div>

         <!-- Language 2 (Patient) -->
         <div>
           <h4 class="text-lg font-semibold text-gray-900 mb-3">Taal van pati√´nt <span id="patient-lang-display" class="text-sm text-gray-500">(English)</span></h4>
           <div id="translation-output" class="min-h-24 p-4 bg-blue-50 rounded-lg border border-blue-200 text-blue-800">
             <span class="text-blue-400">Automatische vertaling verschijnt hier...</span>
           </div>
         </div>
       </div>

       <!-- Live Conversation Display -->
       <div class="bg-white rounded-2xl p-6 shadow-sm border border-gray-200 mb-8">
         <h3 class="text-xl font-semibold text-gray-900 mb-4">Live Gesprek</h3>
         <div id="tolk-conversation-history" class="space-y-4 max-h-64 overflow-y-auto custom-scrollbar">
           <div class="text-gray-500 text-center py-8">Live gesprek wordt hier weergegeven tijdens de sessie...</div>
         </div>
         <p class="text-sm text-gray-500 mt-4">Na het gesprek kunt u de samenvatting kopi√´ren naar uw HIS-systeem via SOEP verslag</p>
       </div>

       <!-- How it works -->
       <div class="bg-blue-50 rounded-2xl p-6 border border-blue-200">
         <h3 class="text-lg font-semibold text-blue-900 mb-3">Hoe werkt de Intelligente Tolk?</h3>
         <div class="grid md:grid-cols-2 gap-4 text-sm text-blue-800">
           <div class="space-y-2">
             <p><strong>1. Live gesprek:</strong> AI luistert en vertaalt in real-time</p>
             <p><strong>2. Speech-to-speech:</strong> Spreek en krijg direct gesproken antwoord</p>
             <p><strong>3. Automatische detectie:</strong> Herkent taal en vertaalt naar de andere</p>
           </div>
           <div class="space-y-2">
             <p><strong>4. Live weergave:</strong> Gesprek wordt live getoond, niet opgeslagen</p>
             <p><strong>5. SOEP integratie:</strong> Na gesprek via SOEP naar HIS-systeem</p>
             <p><strong>6. Een-klik-bediening:</strong> Simpel en intu√Øtief gebruik</p>
           </div>
         </div>
       </div>
    </div>
  </main>

  <!-- Scripts -->
  <script>
    // Tab switching functionality
    function switchTab(tabName) {
      // Hide all tab contents
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
      });
      
      // Remove active class from all nav tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab content
      document.getElementById(tabName + '-tab').classList.remove('hidden');
      
      // Add active class to selected nav tab
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
    }

    // Navigation tab click handlers
    document.querySelectorAll('.nav-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        const tabName = tab.getAttribute('data-tab');
        switchTab(tabName);
      });
    });

    // Profile dropdown toggle
    function toggleMenu() {
      document.getElementById('dropdown-menu').classList.toggle('hidden');
    }

    // Close dropdown when clicking outside
    window.addEventListener('click', e => {
      if (!e.target.closest('button') && !e.target.closest('#dropdown-menu')) {
        document.getElementById('dropdown-menu').classList.add('hidden');
      }
    });



    // SOEP Generation functionality
  async function generateSOEP() {
    const promptText = document.getElementById('text-input').value.trim();
    if (!promptText) {
        alert('Voer eerst tekst in of maak een opname.');
      return;
    }

      showLoading(true);

    try {
        const response = await fetch('https://441c9f8f3296.ngrok-free.app/generate-soep', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt: promptText })
      });
        
        const data = await response.json();
        
        if (data.error) {
          throw new Error(data.error);
        }
        
        // Populate SOEP sections
        ['s', 'o', 'e', 'p'].forEach(section => {
          const content = data[section] || 'Geen gegevens beschikbaar';
          document.getElementById(`${section}-content`).innerHTML = formatContent(content);
        });
        
        // Show results and switch to SOEP tab
      document.getElementById('verslag-container').classList.remove('hidden');
        
        // Smooth scroll to results
        setTimeout(() => {
          document.getElementById('verslag-container').scrollIntoView({ 
            behavior: 'smooth', 
            block: 'start' 
          });
        }, 100);
        
      } catch (error) {
        console.error('Error generating SOEP:', error);
        alert('Er is een fout opgetreden bij het genereren van het SOEP-verslag. Probeer het opnieuw.');
    } finally {
        showLoading(false);
      }
    }

    function formatContent(content) {
      // Format bullet points and structure content nicely
      return content
        .replace(/\n/g, '<br>')
        .replace(/‚Ä¢\s*/g, '<br>‚Ä¢ ')
        .replace(/^<br>/, '');
    }

    function copySection(sectionId) {
      const element = document.getElementById(sectionId);
      const text = element.innerText || element.textContent;
      
      navigator.clipboard.writeText(text).then(() => {
        // Visual feedback
        const button = element.parentElement.querySelector('button');
        const originalText = button.textContent;
        button.textContent = '‚úì Gekopieerd';
        button.classList.add('bg-green-100', 'text-green-600');
        
        setTimeout(() => {
          button.textContent = originalText;
          button.classList.remove('bg-green-100', 'text-green-600');
        }, 2000);
      }).catch(err => {
        console.error('Copy failed:', err);
        alert('Kopi√´ren mislukt. Probeer het opnieuw.');
      });
    }

    // Live Transcription functionality
    let isLiveTranscribing = false;
    let transcriptionSocket = null;
    let currentText = '';
    let typingInterval = null;
    let recordingCancelled = false;

    

    function typeText(element, text, speed = 50) {
      return new Promise((resolve) => {
        let i = 0;
        element.classList.add('typing-cursor');
        
        typingInterval = setInterval(() => {
          if (i < text.length) {
            element.value = currentText + text.substring(0, i + 1);
            i++;
          } else {
            element.classList.remove('typing-cursor');
            clearInterval(typingInterval);
            resolve();
          }
        }, speed);
      });
    }

    async function startLiveTranscription() {
      if (isLiveTranscribing) {
        stopLiveTranscription();
        return;
      }

      try {
        const textarea = document.getElementById('text-input');
        textarea.classList.add('live-transcription');
        textarea.placeholder = 'Live transcriptie actief... spreek nu...';
        
        const btn = document.getElementById('live-transcribe-btn');
        const btnText = document.getElementById('transcribe-btn-text');
        btn.classList.remove('bg-red-500', 'hover:bg-red-600');
        btn.classList.add('bg-green-500', 'hover:bg-green-600');
        btnText.textContent = 'Stop Transcriptie';
        
        isLiveTranscribing = true;
        
        // Start actual live transcription via SocketIO
        initializeSocketIO();
        
      } catch (error) {
        console.error('Live transcription error:', error);
        alert('Kon live transcriptie niet starten. Controleer uw verbinding.');
        stopLiveTranscription();
      }
    }

    let socket = null;

    function initializeSocketIO() {
      // Initialize SocketIO connection
      socket = io('http://localhost:5000');
      
      // Listen for transcription events
      socket.on('transcription', async function(data) {
        if (data.text && isLiveTranscribing) {
          const textarea = document.getElementById('text-input');
          currentText = textarea.value;
          await typeText(textarea, ' ' + data.text.trim());
          currentText = textarea.value;
        }
      });
      
      socket.on('transcription_status', function(data) {
        console.log('Transcription status:', data.status);
      });
      
      socket.on('connect', function() {
        console.log('Connected to server');
        socket.emit('start_transcription');
      });
      
      socket.on('disconnect', function() {
        console.log('Disconnected from server');
      });
    }

                 function stopLiveTranscription() {
       isLiveTranscribing = false;
       
       if (socket) {
         socket.emit('stop_transcription');
         socket.disconnect();
         socket = null;
       }
       
       if (typingInterval) {
         clearInterval(typingInterval);
       }
       
       const textarea = document.getElementById('text-input');
       textarea.classList.remove('live-transcription', 'typing-cursor');
       textarea.placeholder = 'Voer hier uw consultnotities in of gebruik de opnamefunctie...';
       
       const btn = document.getElementById('live-transcribe-btn');
       const btnText = document.getElementById('transcribe-btn-text');
       btn.classList.remove('bg-green-500', 'hover:bg-green-600');
       btn.classList.add('bg-red-500', 'hover:bg-red-600');
       btnText.textContent = 'Start Live Transcriptie';
     }



    // Utility functions
    function showLoading(show) {
      const overlay = document.getElementById('loading-overlay');
      overlay.style.display = show ? 'flex' : 'none';
    }

    // Event listeners
    document.getElementById('generate-soep').addEventListener('click', generateSOEP);
    document.getElementById('live-transcribe-btn').addEventListener('click', startLiveTranscription);
    
         // Auto-expanding textarea
     const textarea = document.getElementById('text-input');
     textarea.addEventListener('input', function() {
       this.style.height = 'auto';
       this.style.height = Math.min(this.scrollHeight, 200) + 'px';
     });

          // Intelligente Live Tolk (One-button smart translation)
     let tolkRecognition = null;
     let tolkConversationHistory = [];
     let isRecording = false;

     // Initialize intelligent speech recognition
     function initializeIntelligentTolk() {
       if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
         const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
         
         tolkRecognition = new SpeechRecognition();
         tolkRecognition.continuous = false;
         tolkRecognition.interimResults = true;
         tolkRecognition.lang = 'auto'; // Will be set dynamically
         
         setupTolkRecognitionEvents();
       } else {
         console.error('Speech recognition not supported');
         alert('Spraakherkenning wordt niet ondersteund in deze browser. Gebruik Chrome voor de beste ervaring.');
       }
     }

     function setupTolkRecognitionEvents() {
       tolkRecognition.onresult = function(event) {
         let transcript = '';
         for (let i = event.resultIndex; i < event.results.length; i++) {
           transcript += event.results[i][0].transcript;
         }
         
         // Update live transcript
         document.getElementById('live-transcript').innerHTML = transcript || '<span class="text-gray-400">Gesproken woorden verschijnen hier...</span>';
         
         if (event.results[event.results.length - 1].isFinal) {
           intelligentTranslateAndSpeak(transcript);
         }
       };
       
       tolkRecognition.onstart = function() {
         updateTolkStatus('Luisteren...', 'bg-green-100 text-green-600');
         isRecording = true;
       };
       
       tolkRecognition.onend = function() {
         updateTolkStatus('Klaar om te starten', 'bg-gray-100 text-gray-600');
         isRecording = false;
       };

       tolkRecognition.onerror = function(event) {
         console.error('Speech recognition error:', event.error);
         updateTolkStatus('Fout - probeer opnieuw', 'bg-red-100 text-red-600');
         isRecording = false;
       };
     }

     function updateTolkStatus(text, className) {
       const statusEl = document.getElementById('tolk-status');
       statusEl.textContent = text;
       statusEl.className = `px-4 py-2 rounded-full text-sm inline-block mb-4 ${className}`;
     }

     async function intelligentTranslateAndSpeak(spokenText) {
       updateTolkStatus('AI analyseert...', 'bg-yellow-100 text-yellow-600');
       
       try {
         const language1 = document.getElementById('language-1').value;
         const language2 = document.getElementById('language-2').value;
         
         // Send to AI for intelligent language detection and translation
         const response = await fetch('https://441c9f8f3296.ngrok-free.app/intelligent-translate', {
           method: 'POST',
           headers: {
             'Content-Type': 'application/json',
           },
           body: JSON.stringify({
             spoken_text: spokenText,
             language_1: language1,
             language_2: language2
           })
         });
         
         const data = await response.json();
         
         if (data.error) {
           throw new Error(data.error);
         }
         
         // Display results in Dutch
         const translationOutput = document.getElementById('translation-output');
         translationOutput.innerHTML = `
           <div class="mb-3">
             <p class="text-sm text-blue-600 font-medium">Gedetecteerde taal: ${data.detected_language_name}</p>
             <p class="text-sm text-blue-600">Vertaald naar: ${data.target_language_name}</p>
           </div>
           <div class="text-blue-800 font-medium">${data.translation}</div>
         `;
         
         // Speak the translation
         speakTranslation(data.translation, data.target_language);
         
         // Add to conversation history
         addToTolkHistory(spokenText, data.translation, data.detected_language_name, data.target_language_name);
         
         updateTolkStatus('Vertaling voltooid', 'bg-green-100 text-green-600');
         
         // Reset status after 2 seconds
         setTimeout(() => {
           updateTolkStatus('Klaar om te starten', 'bg-gray-100 text-gray-600');
         }, 2000);
         
       } catch (error) {
         console.error('Intelligent translation error:', error);
         updateTolkStatus('Vertaling mislukt', 'bg-red-100 text-red-600');
         
         const translationOutput = document.getElementById('translation-output');
         translationOutput.innerHTML = '<span class="text-red-600">Er is een fout opgetreden bij de vertaling. Probeer het opnieuw.</span>';
         
         setTimeout(() => {
           updateTolkStatus('Klaar om te starten', 'bg-gray-100 text-gray-600');
         }, 3000);
       }
     }

     function speakTranslation(text, languageCode) {
       if ('speechSynthesis' in window) {
         const utterance = new SpeechSynthesisUtterance(text);
         utterance.lang = languageCode;
         utterance.rate = 0.9;
         utterance.pitch = 1;
         
         // Find voice for the language
         const voices = speechSynthesis.getVoices();
         const voice = voices.find(v => v.lang.startsWith(languageCode));
         if (voice) {
           utterance.voice = voice;
         }
         
         speechSynthesis.speak(utterance);
       }
     }

     function addToTolkHistory(original, translation, fromLang, toLang) {
       const historyItem = {
         timestamp: new Date(),
         original: original,
         translation: translation,
         fromLanguage: fromLang,
         toLanguage: toLang
       };
       
       tolkConversationHistory.push(historyItem);
       updateTolkConversationDisplay();
     }

     function updateTolkConversationDisplay() {
       const historyEl = document.getElementById('tolk-conversation-history');
       
       if (tolkConversationHistory.length === 0) {
         historyEl.innerHTML = '<div class="text-gray-500 text-center py-8">Gesprek geschiedenis verschijnt hier...</div>';
         return;
       }
       
       historyEl.innerHTML = tolkConversationHistory.map((item, index) => `
         <div class="border-l-4 border-blue-500 bg-blue-50 p-4 rounded-r-lg">
           <div class="flex justify-between items-start mb-2">
             <span class="font-medium text-blue-900">
               Gesprek ${index + 1} (${item.fromLanguage} ‚Üí ${item.toLanguage})
             </span>
             <span class="text-xs text-gray-500">${item.timestamp.toLocaleTimeString()}</span>
           </div>
           <div class="text-sm text-gray-700 mb-1"><strong>Origineel (${item.fromLanguage}):</strong> ${item.original}</div>
           <div class="text-sm text-gray-600"><strong>Vertaling (${item.toLanguage}):</strong> ${item.translation}</div>
         </div>
       `).join('');
       
       historyEl.scrollTop = historyEl.scrollHeight;
     }

     // Live conversation gets cleared automatically when session ends
     // No manual clear/export functions needed for live translator

     // Language name mappings
     const languageNames = {
       'nl': 'Nederlands',
       'en': 'English',
       'ar': 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©',
       'tr': 'T√ºrk√ße',
       'pl': 'Polski',
       'es': 'Espa√±ol',
       'fr': 'Fran√ßais',
       'de': 'Deutsch',
       'it': 'Italiano',
       'pt': 'Portugu√™s',
       'ru': '–†—É—Å—Å–∫–∏–π',
       'zh': '‰∏≠Êñá',
       'hi': '‡§π‡§ø‡§®‡•ç‡§¶‡•Ä',
       'ur': 'ÿßÿ±ÿØŸà'
     };

     // Update language displays
     function updateLanguageDisplays() {
       const lang1 = document.getElementById('language-1')?.value || 'nl';
       const lang2 = document.getElementById('language-2')?.value || 'en';
       
       const doctorDisplay = document.getElementById('doctor-lang-display');
       const patientDisplay = document.getElementById('patient-lang-display');
       
       if (doctorDisplay) {
         doctorDisplay.textContent = `(${languageNames[lang1] || lang1})`;
       }
       if (patientDisplay) {
         patientDisplay.textContent = `(${languageNames[lang2] || lang2})`;
       }
     }

     // Initialize intelligent tolk when page loads
     document.addEventListener('DOMContentLoaded', function() {
       initializeIntelligentTolk();
       
       // Update language displays when selections change
       const lang1Select = document.getElementById('language-1');
       const lang2Select = document.getElementById('language-2');
       
       if (lang1Select) {
         lang1Select.addEventListener('change', updateLanguageDisplays);
       }
       if (lang2Select) {
         lang2Select.addEventListener('change', updateLanguageDisplays);
       }
       
       // Initial update
       updateLanguageDisplays();
       
       // Single record button event listeners
       const tolkBtn = document.getElementById('tolk-record-btn');
       
       if (tolkBtn) {
         // Mouse events
         tolkBtn.addEventListener('mousedown', function() {
           if (tolkRecognition && !isRecording) {
             tolkRecognition.start();
           }
         });
         
         tolkBtn.addEventListener('mouseup', function() {
           if (tolkRecognition && isRecording) {
             tolkRecognition.stop();
           }
         });
         
         // Touch events for mobile
         tolkBtn.addEventListener('touchstart', function(e) {
           e.preventDefault();
           if (tolkRecognition && !isRecording) {
             tolkRecognition.start();
           }
         });
         
         tolkBtn.addEventListener('touchend', function(e) {
           e.preventDefault();
           if (tolkRecognition && isRecording) {
             tolkRecognition.stop();
           }
         });

         // Prevent context menu on long press
         tolkBtn.addEventListener('contextmenu', function(e) {
           e.preventDefault();
         });
       }
    });
  </script>
</body>
</html>
